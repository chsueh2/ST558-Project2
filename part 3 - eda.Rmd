---
title: "ST558 Porject 1: Part 3"
author: "Bridget Knapp and Chien-Lan Hsueh"
institute: Online Statistics Master Program, NCSU
date: "`r Sys.Date()`"
output:
  html_notebook:
    theme: cerulean
    highlight: haddock
    code_folding: none
  html_document:
    df_print: paged
---

```{r include=FALSE}
knitr::opts_chunk$set(fig.path = "./images/")
```


## Summarizations

> You should produce some basic (but meaningful) summary statistics and plots about the training data you
are working with (especially as it relates to your response).
>
> As you will automate this same analysis across other data, you canâ€™t describe the trends you see in the graph (unless you want to try to automate that!). You should describe what to look for in the summary statistics/plots to help the reader understand the summary or graph. Ex: A scatter plot with the number of shares on the y-axis and the positive word rate on the x-axis is created:
>
> 'We can inspect the trend of shares as a function of the positive word rate. If the points show an upward trend, then articles with more positive words tend to be shared more often. If we see a negative trend then articles with more positive words tend to be shared less often.'
>
> Each group member is responsible for producing some summary statistics (means, sds, contingency tables, etc.) and for producing at least three graphs (each) of the data.


"part 2 - data.Rmd"


```{r, include = FALSE}
knitr::knit("part 2 - data.Rmd", output = tempfile())
```



## Start here...

```{r}
# check balance - compare ecdf of train and test sets
plot(ecdf(df_train$shares), col = "blue", main = "Empirical Cumulative Distribution", xlab = "shares")
plot(ecdf(df_test$shares), col = "red", add = T)
```


```{r}
table(df_train$channel)
channel <- "lifestyle"          

# subset by channel
df_train_x <- df_train %>% filter(channel == channel)
df_test_x <- df_test %>% filter(channel == channel)
```

```{r 8:29_7_7_2022}
#A summary table showing the sample size (N), mean, standard deviation (Std. Dev.), minimum (Min), 25th percentile, 75th percentile, and maximum (Max)
library(vtable)
st(df_train_x)
```

```{r 7:31_7_7_2022}
A <- df_train_x %>%
  select(kw_avg_max,shares)

g <- ggplot(A, aes(x = kw_avg_max))
g + geom_histogram(color = "blue", fill = "red",
size = 2, binwidth = 30) +
  labs(x = "Best Keyword (Average Number of Shares)", title = "Distribution of Shares by Best Keyword", y="Number of Shares")
```

```{r 8:10_7_7_2022}
#we need to be able to cycle through the channels
#maybe something like this: A <- df_train_x %>% filter(channel==channel)
A <- df_train_x %>% filter(channel=="lifestyle") 

A <- dplyr::select_if(A, is.numeric)

r <- cor(A, use="complete.obs")
library(ggplot2)
library(ggcorrplot)
ggcorrplot(r, 
            hc.order = TRUE, 
            type = "lower",
            tl.cex = 6)
```

```{r 5:40_7_8_2022}

avg_positive_polarity_Sum <- df_train_x %>% group_by(avg_positive_polarity) %>% summarize(prop_avg_positive_polarity = mean(shares),n = n())
avg_positive_polarity_Sum

ggplot(avg_positive_polarity_Sum, aes(x=avg_positive_polarity,y=prop_avg_positive_polarity,size=n)) + geom_point(stat="identity") +
  labs(x = "Average Polarity of Positive words", title = "Average Polarity of Positive words",y="Proportion of Average Polarity of Positive words")

```

```{r 5:58_7_8_2022}

g <- ggplot(df_train_x, aes(x = shares, y = self_reference_avg_sharess,col=weekday))
g + geom_point() +
  labs(x = "Number of Shares", title = "Number of Shares vs. Avg. Number of Shares of Referenced Articles in Mashable", y="Avg. Number of Shares of Referenced Articles in Mashable")


```

```{r 6:06_7_8_2022}
g <- ggplot(df_train_x, aes(x = shares, y = n_tokens_content,group=n_tokens_title,fill=shares))
g + geom_boxplot(fill = "grey") +
  labs(x = "Number of Shares", title = "Distribution of Shares Grouped by Number of Words in Article", y="Number of Words in the Article")
```





```{r}
# quick summaries of numeric and categorical variables
skim(df_train_x)
```



```{r}
#mean(df_train_x$shares)
```


Form `r channel` news channel subset, we found the mean of `shares` is `r mean(df_train_x, na.rm)`.